---
# TODO - get rid of this check and rely on a created file or something ...
- name: Docker | Check if docker is installed
  command: which docker
  register: docker_installed
  ignore_errors: true

- name: Docker | Add docker-engine repo and install docker
  shell: "curl -fsSL https://get.docker.com/ | bash -s - {% if docker_china_mirror %}--mirror AzureChinaCloud{% endif %}"
  when: docker_installed.rc != 0

- name: Docker | Start and Enable docker
  service:
    name: docker
    state: started
    enabled: true

- include: configure.yml
- include: packages.yml
- include: users.yml